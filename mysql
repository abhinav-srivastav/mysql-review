//1
 select shape,color, case shape 
    when 'rectangle' THEN side1*side2
     when 'circle' THEN PI()*side1*side1 
    when 'triangle' THEN sqrt(3)/4*side1*side1
    else side1*side1 
    end
    as area from blocks order by id;
+-----------+--------+--------+
| shape     | color  | area   |
+-----------+--------+--------+
| triangle  | red    |     25 |
| square    | red    |     25 |
| rectangle | red    |      4 |
| circle    | red    |  78.50 |
| circle    | blue   |  12.56 |
| square    | blue   |     49 |
| square    | yellow |     64 |
| triangle  | yellow |      4 |
| triangle  | blue   |      0 |
| circle    | green  | 314.00 |
| square    | green  |      1 |
| square    | cyan   |     16 |
| rectangle | cyan   |     49 |
| rectangle | yellow |     25 |
| rectangle | white  |      4 |
| circle    | white  |  50.24 |
+-----------+--------+--------+
16 rows in set (0.00 sec)



//2
select shape,sum(case shape 
  when 'rectangle' THEN side1*side2
  when 'circle' THEN PI()*side1*side1 
  when 'triangle' THEN SQRT(3)/4*side1*side1
  else side1*side1 
  end) as area from blocks group by shape;
+-----------+-------------------+
| shape     | area              |
+-----------+-------------------+
| circle    |   455.53093477052 |
| rectangle |                94 |
| square    |               155 |
| triangle  | 16.45448267190433 |
+-----------+-------------------+
4 rows in set (0.00 sec)


//3

 select shape,color,((case shape 
  when 'rectangle' then side1*side2
  when 'circle' then PI()*side1*side1 
  when 'triangle' then SQRT(3)/4*side1*side1
  else side1*side1 
  end) * qty) as area from blocks left join block_qty on block_id = blocks.id;
+-----------+--------+--------------------+
| shape     | color  | area               |
+-----------+--------+--------------------+
| triangle  | red    |  75.77722283113837 |
| square    | red    |                125 |
| rectangle | red    |                 24 |
| circle    | red    | 157.07963267948966 |
| circle    | blue   |                  0 |
| square    | blue   |                245 |
| square    | yellow |                320 |
| triangle  | yellow | 13.856406460551018 |
| triangle  | blue   | 15.588457268119896 |
| circle    | green  | 2513.2741228718346 |
| square    | green  |                  8 |
| square    | cyan   |                 96 |
| rectangle | cyan   |                336 |
| rectangle | yellow |                 10 |
| rectangle | white  |                140 |
| circle    | white  |               NULL |
+-----------+--------+--------------------+
16 rows in set (0.00 sec)



//4
select color,(sum(case shape
    when 'rectangle' then side1*side2
    when 'circle' then PI()*side1*side1
    when 'triangle' then SQRT(3)/4*side1*side1
    else side1*side1 
    end) * qty) as area
from blocks join block_qty on block_id = blocks.id group by  color having area > 300;
+--------+--------------------+
| color  | area               |
+--------+--------------------+
| cyan   |                432 |
| green  | 2521.2741228718346 |
| red    |  856.5559372093522 |
| yellow |  378.6602540378444 |
+--------+--------------------+
4 rows in set (0.00 sec)





















